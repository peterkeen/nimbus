#!/usr/bin/env bash
set -e
set -x

cd $MISE_PROJECT_ROOT/talos

#MISE description="Apply talhelper config"
#MISE depends=["talos:setup"]
#USAGE flag "--insecure" help="ignore insecure certificates"
#USAGE flag "--reboot" help="apply with reboot"

command="apply"
insecure=""
reboot=""

if [ "$usage_reboot" == "true" ]; then
    insecure="--extra-flags='--mode=reboot'"
fi

if [ "$usage_insecure" == "true" ]; then
    reboot="--extra-flags='--insecure'"
fi

generated=$(talhelper gencommand $command $insecure $reboot)
echo $generated
eval $generated
